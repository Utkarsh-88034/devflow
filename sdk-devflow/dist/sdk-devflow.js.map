{"version":3,"file":"sdk-devflow.js","sources":["../src/DevFlow.ts","../src/DevFlowProvider.tsx","../src/useDevFlow.tsx"],"sourcesContent":["import { AxiosError } from 'axios'\r\nimport { request } from 'graphql-request'\r\n\r\nconst api = 'http://localhost/5000/graphql/'\r\nconst projectId = '64c89fc4eb520a12abee5383'\r\n\r\ninterface UserInputType {\r\n  [key: string]: any\r\n}\r\ninterface IssueAdditionalDataType {\r\n  [key: string]: any\r\n}\r\n\r\nexport class DevFlow {\r\n  apiKey: string\r\n  private static instance: DevFlow\r\n\r\n  private constructor(apiKey: string) {\r\n    this.apiKey = apiKey\r\n  }\r\n\r\n  // private authenticateUser() {}\r\n\r\n  //Initialize\r\n\r\n  static initialize(apiKey: string): DevFlow {\r\n    if (!DevFlow.instance) {\r\n      DevFlow.instance = new DevFlow(apiKey)\r\n    }\r\n    return DevFlow.instance\r\n  }\r\n\r\n  public generateIssueDetails(\r\n    error: Error | AxiosError,\r\n    data: IssueAdditionalDataType,\r\n    type: String\r\n  ) {\r\n    const stackTrace = error.stack\r\n    const errorMessage = error.message\r\n    const errorType = error.constructor.name\r\n    const errorLocation = stackTrace!.split('\\n')[1]\r\n    const additionalDetails = {\r\n      type: type,\r\n      data: data\r\n    }\r\n\r\n    const environment = {\r\n      // userAgent: navigator.userAgent,\r\n      appVersion: '1.0.0',\r\n      route: 'window.location.href'\r\n    }\r\n    const errorConfig = {\r\n      title: errorType,\r\n      description: `\r\n      A ${type} error of type ${errorType} occurred at ${errorLocation}:\r\n   \r\n      Error Message: ${errorMessage}\r\n   \r\n      Stack Trace:\r\n      ${stackTrace}\r\n   \r\n      Additional information:\r\n      ${JSON.stringify(additionalDetails, null, 2)}\r\n      `,\r\n      stackTrace: stackTrace,\r\n      errorMessage: errorMessage,\r\n      errorType: errorType,\r\n      errorLocation: errorLocation,\r\n      additionalContext: JSON.stringify(additionalDetails),\r\n      environment: JSON.stringify(environment)\r\n    }\r\n\r\n    const query = `\r\n    mutation create($title: String!,$description: String!,$stackTrace: String!,$errorMessage: String!,$errorType: String!,$errorLocation: String!,$additionalContext: String!,$environment: String!,$project: ID!) {\r\n      newIssue(title:$title, description:$description, stackTrace:$stackTrace, errorMessage:$errorMessage, errorType:$errorType, errorLocation:$errorLocation, additionalContext:$additionalContext, environment:$environment,project:$project) {\r\n        id\r\n        title\r\n        description\r\n      }\r\n    }\r\n  `\r\n    const variables = {\r\n      title: errorConfig.title,\r\n      description: errorConfig.description,\r\n      stackTrace: errorConfig.stackTrace,\r\n      errorType: errorConfig.errorType,\r\n      errorLocation: errorConfig.errorLocation,\r\n      additionalContext: errorConfig.additionalContext, // Use the JSON string here\r\n      environment: errorConfig.environment,\r\n      errorMessage: errorConfig.errorMessage,\r\n      project: projectId\r\n    }\r\n\r\n    const sendInfo = async () => {\r\n      //@ts-ignore\r\n      request(api, query, variables)\r\n    }\r\n\r\n    sendInfo()\r\n  }\r\n\r\n  //General Error\r\n\r\n  public captureGeneralError(error: Error) {\r\n    this.generateIssueDetails(error, {}, 'General Error')\r\n  }\r\n\r\n  //AJAX Error\r\n\r\n  public captureAJAXError(error: AxiosError) {\r\n    const data = {\r\n      url: error.response!.config.url,\r\n      headers: error.response!.headers,\r\n      method: error.response!.config.method\r\n    }\r\n    this.generateIssueDetails(error, data, 'AJAX Error')\r\n  }\r\n\r\n  //User Interface Error\r\n\r\n  public captureUIInterfaceError(\r\n    error: Error,\r\n    event: Event,\r\n    target: EventTarget\r\n  ) {\r\n    const data = {\r\n      event: event,\r\n      target: target\r\n    }\r\n    this.generateIssueDetails(error, data, 'UI Interface Error')\r\n  }\r\n\r\n  //Input Error\r\n\r\n  public captureFromInputError(error: Error, userInput: UserInputType) {\r\n    this.generateIssueDetails(error, userInput, 'Form Input Error')\r\n  }\r\n}\r\n","import { ReactNode } from 'react'\r\nimport React from 'react'\r\n\r\nimport { DevFlow } from './DevFlow' // Import your DevFlow class\r\n\r\nexport const DevFlowContext = React.createContext<DevFlow | undefined>(\r\n  undefined\r\n)\r\n\r\nexport const DevFlowProvider: React.FC<{\r\n  apiKey: string\r\n  children: ReactNode\r\n}> = ({ apiKey, children }) => {\r\n  const sdk = DevFlow.initialize(apiKey)\r\n  const contextValue = {\r\n    sdk,\r\n    captureGeneralError: sdk.captureGeneralError,\r\n    captureAJAXError: sdk.captureAJAXError,\r\n    captureUIInterfaceError: sdk.captureUIInterfaceError,\r\n    captureFromInputError: sdk.captureFromInputError,\r\n    apiKey: sdk.apiKey,\r\n    generateIssueDetails: sdk.generateIssueDetails\r\n    // Add more methods here\r\n  }\r\n  return (\r\n    <DevFlowContext.Provider value={contextValue}>\r\n      {children}\r\n    </DevFlowContext.Provider>\r\n  )\r\n}\r\n","import { useContext } from 'react'\r\nimport { DevFlowContext } from './DevFlowProvider' // Adjust the import path\r\n\r\nexport const useDevFlow = () => {\r\n  const context = useContext(DevFlowContext)\r\n\r\n  if (!context) {\r\n    throw new Error('useDevFlow must be used within a DevFlowProvider')\r\n  }\r\n\r\n  return context\r\n}\r\n"],"names":["api","projectId","DevFlow","apiKey","initialize","instance","_proto","prototype","generateIssueDetails","error","data","type","stackTrace","stack","errorMessage","message","errorType","constructor","name","errorLocation","split","additionalDetails","environment","appVersion","route","errorConfig","title","description","JSON","stringify","additionalContext","query","variables","project","sendInfo","request","Promise","resolve","e","reject","captureGeneralError","captureAJAXError","url","response","config","headers","method","captureUIInterfaceError","event","target","captureFromInputError","userInput","DevFlowContext","React","createContext","undefined","DevFlowProvider","_ref","children","sdk","contextValue","Provider","value","useDevFlow","context","useContext","Error"],"mappings":"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"}